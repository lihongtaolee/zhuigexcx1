(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/sgtool/sgycai/sgycai"],{"0d96":function(e,t,r){"use strict";var n=r("ca7d"),a=r.n(n);a.a},2129:function(e,t,r){"use strict";r.r(t);var n=r("466d"),a=r("575e");for(var i in a)["default"].indexOf(i)<0&&function(e){r.d(t,e,(function(){return a[e]}))}(i);r("0d96");var u=r("828b"),o=Object(u["a"])(a["default"],n["b"],n["c"],!1,null,"66668e26",null,!1,n["a"],void 0);t["default"]=o.exports},"466d":function(e,t,r){"use strict";r.d(t,"b",(function(){return n})),r.d(t,"c",(function(){return a})),r.d(t,"a",(function(){}));var n=function(){var e=this,t=e.$createElement;e._self._c;e._isMounted||(e.e0=function(t){e.gender=1},e.e1=function(t){e.gender=2})},a=[]},"575e":function(e,t,r){"use strict";r.r(t);var n=r("ab71"),a=r.n(n);for(var i in n)["default"].indexOf(i)<0&&function(e){r.d(t,e,(function(){return n[e]}))}(i);t["default"]=a.a},ab71:function(e,t,r){"use strict";(function(e,n){var a=r("47a9");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(r("7eb4")),u=a(r("ee10")),o=a(r("9ed6")),c=a(r("435b")),s={data:function(){return{baobaoname:"",gender:1,birthday:"",fatherHeight:"",motherHeight:"",city:[],cityText:"",currentHeight:"",targetHeight:"",boneAge:"",weight:"",measureTime:"",errorMessage:"",isSubmitting:!1,today:(new Date).toISOString().split("T")[0],apiBaseUrl:"https://x.erquhealth.com/wp-json/zhuige/sgtool",userId:null}},methods:{onBirthdayChange:function(e){this.birthday=e.detail.value},onMeasureTimeChange:function(e){this.measureTime=e.detail.value},onCityChange:function(e){this.city=e.detail.value,this.cityText=this.city.join(" ")},checkLoginStatus:function(){var t=this;return(0,u.default)(i.default.mark((function r(){var a;return i.default.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(a=o.default.getUser(),a&&a.token||(a=e.getStorageSync("user")),a&&a.token){r.next=5;break}throw n.showModal({title:"温馨提示",content:"请先登录后再录入宝宝档案",showCancel:!1,confirmText:"去登录",success:function(t){t.confirm?e.redirectTo({url:"/pages/user/login/login?type=login&tip=录入宝宝档案"}):c.default.navigateBack()}}),new Error("未登录");case 5:if(a.mobile){r.next=8;break}throw n.showModal({title:"温馨提示",content:"为了完善您的用户信息，请先绑定手机号",showCancel:!1,confirmText:"去绑定",success:function(t){t.confirm?e.redirectTo({url:"/pages/user/login/login?type=mobile&tip=录入宝宝档案"}):c.default.navigateBack()}}),new Error("未绑定手机号");case 8:return t.userId=a.user_id,r.abrupt("return",a);case 10:case"end":return r.stop()}}),r)})))()},submitData:function(){var t=this;return(0,u.default)(i.default.mark((function r(){var n,a,u,o,c,s,l,f;return i.default.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return t.errorMessage="",r.prev=1,r.next=4,t.checkLoginStatus();case 4:n=r.sent,r.next=10;break;case 7:return r.prev=7,r.t0=r["catch"](1),r.abrupt("return");case 10:if(t.baobaoname&&t.birthday&&t.currentHeight&&t.fatherHeight&&t.motherHeight&&t.cityText){r.next=13;break}return t.errorMessage="请填写必填项（宝宝姓名、出生日期、实测身高、父母身高、所在城市）",r.abrupt("return");case 13:if(a=parseFloat(t.fatherHeight),u=parseFloat(t.motherHeight),!(a<140||a>220||u<140||u>220)){r.next=18;break}return t.errorMessage="请输入合理的父母身高数值(140-220cm)",r.abrupt("return");case 18:if(o=parseFloat(t.currentHeight),!(o<30||o>200)){r.next=22;break}return t.errorMessage="请输入合理的实测身高数值(30-200cm)",r.abrupt("return");case 22:if(!t.weight){r.next=27;break}if(c=parseFloat(t.weight),!(c<2||c>100)){r.next=27;break}return t.errorMessage="请输入合理的体重数值(2-100kg)",r.abrupt("return");case 27:if(!t.boneAge){r.next=32;break}if(s=parseFloat(t.boneAge),!(s<0||s>18)){r.next=32;break}return t.errorMessage="请输入合理的骨龄数值(0-18岁)",r.abrupt("return");case 32:return t.isSubmitting=!0,r.prev=33,l={user_id:t.userId,baobaoname:t.baobaoname,gender:t.gender,birthday:t.birthday,father_height:t.fatherHeight,mother_height:t.motherHeight,city:t.cityText,current_height:t.currentHeight,target_height:t.targetHeight||null,bone_age:t.boneAge||null,weight:t.weight||null,measure_time:t.measureTime||null},r.next=37,new Promise((function(r,a){e.request({url:"".concat(t.apiBaseUrl,"/save_user_data"),method:"POST",data:l,header:{"content-type":"application/json",Authorization:"Bearer "+n.token},success:function(e){200===e.statusCode?r(e.data):a(new Error("网络请求失败"))},fail:function(e){a(e)}})}));case 37:f=r.sent,0===f.code?(e.showToast({title:"保存成功",icon:"success",duration:2e3}),setTimeout((function(){e.navigateBack()}),2e3)):t.errorMessage=f.msg||"保存失败，请重试",r.next=44;break;case 41:r.prev=41,r.t1=r["catch"](33),t.errorMessage="网络连接失败，请重试";case 44:return r.prev=44,t.isSubmitting=!1,r.finish(44);case 47:case"end":return r.stop()}}),r,null,[[1,7],[33,41,44,47]])})))()}},onShow:function(){this.checkLoginStatus().catch((function(){}))}};t.default=s}).call(this,r("df3c")["default"],r("3223")["default"])},c133:function(e,t,r){"use strict";(function(e,t){var n=r("47a9");r("1e94");n(r("3240"));var a=n(r("2129"));e.__webpack_require_UNI_MP_PLUGIN__=r,t(a.default)}).call(this,r("3223")["default"],r("df3c")["createPage"])},ca7d:function(e,t,r){}},[["c133","common/runtime","common/vendor"]]]);